parameters:    
  - name: Comment
    displayName: Comment - included in Git history and build number
    default: '-'
    type: string    
    
  - name: MergeChanges
    displayName: Merge changes - if unchecked, configurations will be left in a Git branch and not used for subsequent deployments until merged
    default: true
    type: boolean

name: $(Date:yyyyMMdd)$(Rev:.r)
trigger: none
schedules:
- cron: "0 5 * * *"
  displayName: Daily Run 5AM UTC
  branches:
    include:
    - master
  always: true

pool:
  vmImage: windows-latest

resources:
  repositories:
  - repository: Templates
    type: github
    name: simeoncloud/AzurePipelineTemplates
    ref: refs/heads/master
    endpoint: simeoncloud

stages:
- template: Export.yml@Templates
  parameters:
    Comment: ${{ parameters.Comment }}
    ${{ if eq(variables['Build.Reason'], 'Schedule') }}:
      MergeChanges: false
    ${{ if ne(variables['Build.Reason'], 'Schedule') }}:
      MergeChanges: ${{ parameters.MergeChanges }}
    OverrideBaseline: false
